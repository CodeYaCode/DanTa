<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.snda.cloud.virtulization.resource.dao.IVmInfoDao">
	<select id="selectVmInfoCountByCondition" parameterType="vmInfo" resultType="int">
		SELECT
			COUNT(*)
		FROM
			VM_INFO
		WHERE
			`STATUS` != 'Unknown'
		AND
			IS_ENABLED = 1
		AND
			IS_DELETED = 0
		<if test="vmType != null">
		AND
			VM_TYPE = #{vmType}
		</if>
		<if test="imageId != null">
		AND
			IMAGE_ID = #{imageId}
		</if>
		<if test="countType == 'null'">
		AND
			COUNT_TYPE = ''
		</if>
			
	</select>
	
	<select id="selectVmInfoCountNotInType" parameterType="list" resultType="int">
		SELECT
			COUNT(*)
		FROM
			VM_INFO
		WHERE
			`STATUS` != 'Unknown'
		AND
			IS_ENABLED = 1
		AND
			IS_DELETED = 0
		<if test="list != null">
		AND
			VM_TYPE NOT IN
			<foreach collection="list" item="vmType" open="(" close=")" separator=",">
				#{vmType}
			</foreach>
		</if>
	</select>
	
	<select id="selectVmInfoCountNotInImage" parameterType="list" resultType="int">
		SELECT
			COUNT(*)
		FROM
			VM_INFO
		WHERE
			`STATUS` != 'Unknown'
		AND
			IS_ENABLED = 1
		AND
			IS_DELETED = 0
		<if test="list != null">
		AND
			IMAGE_ID NOT IN
			<foreach collection="list" item="imageId" open="(" close=")" separator=",">
				#{imageId}
			</foreach>
		</if>
	</select>
</mapper>